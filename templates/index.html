<!-- templates/index.html -->
{% extends "_base.html" %}

{% block title %}Dashboard — LifePredictor{% endblock %}

{% block content %}
<!-- LEFT SIDEBAR -->
<aside class="sidebar" aria-labelledby="how-title">
		<div class="card sidebar-card">
				<h2 id="how-title" class="sidebar-title">How It Works</h2>

				<div class="accordion">
						<button class="acc-item" aria-expanded="true">
								<span>Our Prediction Model</span>
								<span class="chev">▾</span>
						</button>

						<div class="acc-panel">
								<p>
								Our model utilizes a robust regression algorithm trained on global demographic
								and environmental data from the past five decades to forecast life expectancy.
								</p>
						</div>

						<button class="acc-item" aria-expanded="false">
								<span>Data Sources</span>
								<span class="chev">▸</span>
						</button>
						<div class="acc-panel">
								<p>World Bank, WHO, UN, open datasets and peer-reviewed sources.</p>
						</div>

						<button class="acc-item" aria-expanded="false">
								<span>Disclaimer</span>
								<span class="chev">▸</span>
						</button>
						<div class="acc-panel">
								<p>Predictions are indicative and not medical advice. Use responsibly.</p>
						</div>
				</div>
		</div>
</aside>

<!-- MAIN CONTENT -->
<main class="main-content">

		<div class="card sidebar-card">
				<h2 class="sidebar-title">Why Life Expectancy?</h2>
				<p>
				Life expectancy is influenced by many factors — from economic conditions and healthcare access to environmental quality.
				By exploring different countries and their data, you can see how decisions and policies impact real lives over decades.
				</p>
		</div>

		<div class="card sidebar-card">
				<h2 class="sidebar-title">Try It Yourself</h2>
				<p>
				Select a country from the dropdown or adjust the sliders to explore how GDP, CO₂ emissions, and child mortality
				influence life expectancy. Compare nations and uncover surprising insights.
				</p>
		</div>


		<!-- Prediction form -->
		<section class="card form-card" aria-labelledby="predict-title">
				<h2 id="predict-title">Predict Life Expectancy</h2>
				<p class="muted">Enter the required demographic and environmental metrics below to get your prediction.</p>

				<form id="predict-form" class="predict-form" novalidate>

						<label>
								Select Country:
								<select id="country-select">
										<option value="">--Choose--</option>
										{% for country in countries %}
										<option value="{{ country }}">{{ country }}</option>
										{% endfor %}
								</select>
						</label>
						<label>
								GDP Per Capita (USD)
								<input type="number" id="gdp" name="gdp" value="75000" min="1000" max="100000" step="1" required />
								<input type="range" min="1000" max="100000" id="gdp-slider" oninput="gdp.value = this.value" />
						</label>

						<label>
								CO₂ Emissions Per Capita (tonnes)
								<input type="number" id="co2" name="co2" value="5.2" min="0" step="0.1" required />
								<input type="range" min="0" max="50" step="0.1" id="co2-slider" oninput="co2.value = this.value" />
						</label>

						<label>
								Child Mortality Per 1000 Live Births
								<input type="number" id="mortality" name="mortality" value="30" min="0" step="1" required />
								<input type="range" min="0" max="1000"  id="mortality-slider" oninput="mortality.value = this.value" />
						</label>

						<div class="form-actions">
								<button type="submit" class="btn primary" id="predict-btn">Predict Life Expectancy</button>
						</div>
				</form>
		</section>

		<!-- Predicted result -->
		<section class="card result-card" aria-live="polite" aria-atomic="true">
				<h3 class="result-title">Predicted Life Expectancy</h3>
				<div class="result-value" id="result-value">
						<span class="value-number">—</span>
						<span class="value-unit">years</span>
				</div>
				<p id="result-text" class="muted small">Enter metrics and click Predict Life Expectancy.</p>
		</section>

		<!-- Chart -->
		<!-- <section class="card chart-card" aria-labelledby="chart-title"> -->
		<!--   <h3 id="chart-title">Global Child Mortality Trends</h3> -->
		<!--   <p class="muted small">Historical data points (deaths per 1000 live births globally)</p> -->
		<!--   <div class="svg-wrap"> -->
		<!--   </div> -->
		<!-- </section> -->

		{% block extra_scripts %}

		<script>
				const countryData = {{ country_data | tojson }};
				document.getElementById('country-select').addEventListener('change', (e) => {
						const data = countryData[e.target.value];
						if (!data) return;
						document.getElementById('gdp').value = data.gdp_pcap;
						document.getElementById('gdp-slider').value = data.gdp_pcap;
						document.getElementById('co2').value = data.co2_pcap;
						document.getElementById('co2-slider').value = data.co2_pcap;
						document.getElementById('mortality').value = data.child_mort_pcap;
						document.getElementById('mortality-slider').value = data.child_mort_pcap;
				});
		</script>
		{% endblock %}
</main>
{% endblock %}
